version: 1.0
name: linkr
description: >
  Linkr â€” Full-stack escort marketing platform built with Next.js (frontend) and Node.js/Prisma (backend).
  The repository includes Dockerized environments, CI/CD automation, and SEO optimization tools.

directories:
  frontend: ./frontend
  backend: ./backend
  shared: ./shared
  docker: ./ops

entrypoints:
  frontend:
    path: ./frontend
    type: nextjs
    start: npm run dev
    build: npm run build
  backend:
    path: ./backend
    type: node
    start: npm run dev
    build: npm run build

tasks:
  setup:
    - run: npm install --prefix backend
    - run: npm install --prefix frontend
    - run: npx prisma generate --prefix backend

  migrate:
    - run: npx prisma migrate deploy --prefix backend

  test:
    - run: npm test --prefix backend
    - run: npm run lint --prefix frontend

environment:
  node: "24.10.0"
  database: postgresql
  ports:
    - 3000
    - 4000

deploy:
  docker:
    compose_file: ./ops/docker-compose.yml
    services:
      - frontend
      - backend
